<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CommonFeatures.jl</title><meta name="title" content="Home · CommonFeatures.jl"/><meta property="og:title" content="Home · CommonFeatures.jl"/><meta property="twitter:title" content="Home · CommonFeatures.jl"/><meta name="description" content="Documentation for CommonFeatures.jl."/><meta property="og:description" content="Documentation for CommonFeatures.jl."/><meta property="twitter:description" content="Documentation for CommonFeatures.jl."/><meta property="og:url" content="https://ivanuricardo.github.io/CommonFeatures.jl/"/><meta property="twitter:url" content="https://ivanuricardo.github.io/CommonFeatures.jl/"/><link rel="canonical" href="https://ivanuricardo.github.io/CommonFeatures.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CommonFeatures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CommonFeatures"><a class="docs-heading-anchor" href="#CommonFeatures">CommonFeatures</a><a id="CommonFeatures-1"></a><a class="docs-heading-anchor-permalink" href="#CommonFeatures" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/ivanuricardo/CommonFeatures.jl">CommonFeatures</a>.</p><ul><li><a href="#CommonFeatures.art"><code>CommonFeatures.art</code></a></li><li><a href="#CommonFeatures.fullinfocrit"><code>CommonFeatures.fullinfocrit</code></a></li><li><a href="#CommonFeatures.infocrit-Tuple{AbstractArray, Int64}"><code>CommonFeatures.infocrit</code></a></li><li><a href="#CommonFeatures.isstable-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>CommonFeatures.isstable</code></a></li><li><a href="#CommonFeatures.makecompanion-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>CommonFeatures.makecompanion</code></a></li><li><a href="#CommonFeatures.mecm-Tuple{AbstractArray, AbstractVector}"><code>CommonFeatures.mecm</code></a></li><li><a href="#CommonFeatures.ridgerankselect"><code>CommonFeatures.ridgerankselect</code></a></li><li><a href="#CommonFeatures.rrvar-Tuple{AbstractMatrix, Int64, Int64}"><code>CommonFeatures.rrvar</code></a></li><li><a href="#CommonFeatures.rrvaric-Tuple{AbstractMatrix, Int64, Bool}"><code>CommonFeatures.rrvaric</code></a></li><li><a href="#CommonFeatures.simstats-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>CommonFeatures.simstats</code></a></li><li><a href="#CommonFeatures.simulatetuckerdata-Tuple{AbstractVector, AbstractVector, Int64}"><code>CommonFeatures.simulatetuckerdata</code></a></li><li><a href="#CommonFeatures.tensorols-Tuple{AbstractArray, AbstractArray}"><code>CommonFeatures.tensorols</code></a></li><li><a href="#CommonFeatures.tlag"><code>CommonFeatures.tlag</code></a></li><li><a href="#CommonFeatures.tuckerpar"><code>CommonFeatures.tuckerpar</code></a></li><li><a href="#CommonFeatures.tuckerreg-Tuple{AbstractArray, AbstractVector}"><code>CommonFeatures.tuckerreg</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.art" href="#CommonFeatures.art"><code>CommonFeatures.art</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">art(Y, p)</code></pre><p>Compute the Tensor Autoregressive (ART) model using tensor ordinary least squares.</p><p><strong>Arguments</strong></p><ul><li><code>Y::AbstractArray</code>: Matrix or Tensor of size (n1, n2, T) or (n1, n2, ..., nk, T).</li><li><code>p::Int</code>: Order of the autoregressive model.</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: Tensor of size (n1, n2, ..., nk, n1, ..., nk).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Y = rand(3, 2, 100)
p = 2

result = art(Y, p)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/matrixar.jl#L24-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.fullinfocrit" href="#CommonFeatures.fullinfocrit"><code>CommonFeatures.fullinfocrit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fullinfocrit(mardata, p, r̄, maxiters, tucketa, ϵ, stdize)</code></pre><p>Calculate information criteria (aic and bic) for different combinations of Tucker ranks in a matrix autoregressive (MAR) model. Iterates over different time lags to find the best Tucker ranks.</p><p><strong>Fields</strong></p><ul><li><code>mardata::AbstractArray</code>: The matrix-valued time series data.</li><li><code>pmax::Int</code>: The maximum order of the autoregressive model to be considered.</li><li><code>r̄::AbstractVector</code>: A vector specifying the maximum Tucker ranks for each mode. Default is all possible combinations.</li><li><code>maxiters::Int</code>: An integer specifying the number of iterations the Tucker regression should run. Default value is 500.</li><li><code>tucketa::Real</code>: A real value specifying the step size for the Tucker regression. Default value is 1e-02.</li><li><code>ϵ::Real</code>: A real value specifying the convergence criterion for the Tucker regression. Default value is 1e-03.</li><li><code>stdize::Bool</code>: A boolean value specifying whether to standardize the data before running the Tucker regression. Default value is false.</li></ul><p><strong>Output</strong></p><p>A tuple with the following elements:</p><ul><li><code>bic</code>: The Tucker ranks chosen based on the Bayesian Information Criterion (bic).</li><li><code>aic</code>: The Tucker ranks chosen based on the Akaike Information Criterion (aic).</li><li><code>ictable</code>: A 6xN matrix where N is the number of valid Tucker rank combinations. Each column corresponds to a combination, and rows contain the following information:<ul><li>Row 1: Log determinant of the covariance matrix plus a penalty term (bic criterion).</li><li>Row 2: Log determinant of the covariance matrix plus a penalty term (aic criterion).</li><li>Rows 3-6: The chosen Tucker ranks for each mode.</li></ul></li><li>regiters: The number of iterations for each Tucker regression.</li><li>numconv: The number of converged Tucker regressions.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">mardata = randn(4,3,100)  # Example matrix time series data
p = 2
r̄ = [2, 2, 2, 2]
result = infocrit(mardata, p, r̄)
println(&quot;bic Chosen Ranks: &quot;, result.bic)
println(&quot;aic Chosen Ranks: &quot;, result.aic)
println(&quot;Information Criteria Table: &quot;, result.ictable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/infocrit.jl#L150-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.infocrit-Tuple{AbstractArray, Int64}" href="#CommonFeatures.infocrit-Tuple{AbstractArray, Int64}"><code>CommonFeatures.infocrit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">infocrit(mardata, p, r̄, maxiters, tucketa, ϵ, stdize)</code></pre><p>Calculate information criteria (aic and bic) for different combinations of Tucker ranks in a matrix autoregressive (MAR) model.</p><p><strong>Arguments</strong></p><ul><li><code>mardata::AbstractArray</code>: The matrix-valued time series data.</li><li><code>p::Int</code>: The order of the autoregressive model.</li><li><code>r̄::AbstractVector</code>: A vector specifying the maximum Tucker ranks for each mode. Default is all possible combinations.</li><li><code>maxiters::Int</code>: An integer specifying the number of iterations the Tucker regression should run. Default value is 500.</li><li><code>tucketa::Real</code>: A real value specifying the step size for the Tucker regression. Default value is 1e-02.</li><li><code>ϵ::Real</code>: A real value specifying the convergence criterion for the Tucker regression. Default value is 1e-03.</li><li><code>stdize::Bool</code>: A boolean value specifying whether to standardize the data before running the Tucker regression. Default value is false.</li></ul><p><strong>Output</strong></p><p>A tuple with the following elements:</p><ul><li><code>bic</code>: The Tucker ranks chosen based on the Bayesian Information Criterion (bic).</li><li><code>aic</code>: The Tucker ranks chosen based on the Akaike Information Criterion (aic).</li><li><code>ictable</code>: A 6xN matrix where N is the number of valid Tucker rank combinations. Each column corresponds to a combination, and rows contain the following information:<ul><li>Row 1: Log determinant of the covariance matrix plus a penalty term (bic criterion).</li><li>Row 2: Log determinant of the covariance matrix plus a penalty term (aic criterion).</li><li>Rows 3-6: The chosen Tucker ranks for each mode.</li><li>Row 7: The number of iterations for each Tucker regression.</li></ul></li><li>numconv: The number of converged Tucker regressions.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">mardata = randn(4,3,100)  # Example matrix time series data
p = 2
r̄ = [2, 2, 2, 2]
result = infocrit(mardata, p, r̄)
println(&quot;bic Chosen Ranks: &quot;, result.bic)
println(&quot;aic Chosen Ranks: &quot;, result.aic)
println(&quot;Information Criteria Table: &quot;, result.ictable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/infocrit.jl#L57-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.isstable-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T" href="#CommonFeatures.isstable-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>CommonFeatures.isstable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isstable(var)</code></pre><p>Check the stability of a VAR (Vector Autoregressive) model.</p><p>This function checks the stability of a VAR model by analyzing its companion matrix eigenvalues. A VAR model is considered stable if all the eigenvalues of its companion matrix are within the unit circle.</p><p><strong>Arguments</strong></p><ul><li><code>var</code>: Lag matrix in the form required for a <code>VAR</code> model. See the documentation of <code>VAR</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if the VAR model is stable, and <code>false</code> otherwise.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">B = [1.0 2.0;
     3.0 4.0]
var_stable = isstable(B)  # Returns true or false based on the stability of the VAR model</code></pre><p><strong>Note</strong></p><p>The stability of a VAR model is determined by analyzing the eigenvalues of its companion matrix. The companion matrix is constructed using the makecompanion function.</p><p><strong>See Also</strong></p><ul><li><code>makecompanion</code>: Function to create the VAR companion matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/companionmatrix.jl#L34-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.makecompanion-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T" href="#CommonFeatures.makecompanion-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>CommonFeatures.makecompanion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">makecompanion(B::AbstractMatrix{T}) where {T}</code></pre><p>Create the VAR companion matrix.</p><p>Given a VAR of the form yₜ = b₀ + B₁ y<em>t-1 + … + Bₚy</em>t-p + εₜ</p><p>Create the companion matrix. Thus, <span>$B$</span> is a <span>$np	imes np$</span> matrix. </p><p><strong>Arguments</strong></p><p>-<code>B::AbstractMatrix{T}</code>: Lag matrix in the form required for a <code>VAR</code> model. See     the documentation of <code>VAR</code>.</p><p><strong>References</strong></p><ul><li>Kilian, L., &amp; Lütkepohl, H. (2017). Structural Vector Autoregressive Analysis: (1st ed.). Cambridge University Press. https://doi.org/10.1017/9781108164818</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/companionmatrix.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.mecm-Tuple{AbstractArray, AbstractVector}" href="#CommonFeatures.mecm-Tuple{AbstractArray, AbstractVector}"><code>CommonFeatures.mecm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mecm(mardata::AbstractArray, ranks::AbstractVector; p::Int=0, maxiter::Int=500, ϵ::AbstractFloat=1e-03)</code></pre><p>Performs gradient descent optimization for a Matrix Error Correction Model (MECM), iteratively adjusting the estimated parameters to minimize the objective function. The function operates on matrix autoregressive data and returns the optimized matrices along with convergence details.</p><p><strong>Arguments</strong></p><ul><li><code>mardata::AbstractArray</code>: 3D array representing the matrix autoregressive (MAR) data with dimensions (N1, N2, T), where N1 and N2 are the dimensions of each matrix, and T is the number of observations (time points).</li><li><code>ranks::AbstractVector</code>: A vector of length 2 specifying the ranks for matrices U1, U2, U3, and U4 used in the factorization of the model.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>p::Int=0</code>: The lag order of the autoregressive process. If p &gt; 0, the model includes autoregressive terms.</li><li><code>maxiter::Int=500</code>: Maximum number of iterations for the gradient descent algorithm.</li><li><code>ϵ::AbstractFloat=1e-03</code>: Convergence threshold for the gradient descent. The algorithm stops when the difference between consecutive objective values is smaller than this value.</li></ul><p><strong>Returns</strong></p><ul><li><code>U1, U2, U3, U4</code>: Estimated factors from the factorization of the matrices.</li><li><code>D</code>: Estimated matrix of intercept terms.</li><li><code>ϕ1, ϕ2</code>: Autoregressive coefficient matrices (if <code>p &gt; 0</code>).</li><li><code>iters::Int</code>: Number of iterations performed.</li><li><code>fullgrads::Matrix</code>: A matrix tracking the learning rates for U1, U2, U3, U4, and D during each iteration.</li><li><code>converged::Bool</code>: Boolean indicating whether the optimization converged.</li><li><code>llist::Vector</code>: A vector containing the objective function values across iterations.</li></ul><p><strong>Description</strong></p><p>The function initializes the matrices (U1, U2, U3, U4, D, ϕ1, ϕ2) based on the provided data, then iteratively updates these parameters using gradient descent. At each iteration, it computes gradients with respect to each parameter and updates the parameters accordingly. The learning rate for each update is dynamically adjusted using the Hessians of the gradients.</p><p>If autoregressive terms (<code>p &gt; 0</code>) are specified, additional gradient updates for <code>ϕ1</code> and <code>ϕ2</code> are performed.</p><p>The function tracks the progress of the optimization by storing the learning rates, objective function values, and the number of iterations. The optimization stops when convergence is reached (based on the threshold <code>ϵ</code>) or when the maximum number of iterations is exceeded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/mecm.jl#L62-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.ridgerankselect" href="#CommonFeatures.ridgerankselect"><code>CommonFeatures.ridgerankselect</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ridgerankselect(est::AbstractArray, c::Real, r̄=collect(size(est)))::Vector{Int}</code></pre><p>Used to provide an initial guess of the ranks for a Tucker regression using the framework of Lam and Yao (2011) and Wang et. al (2023). Given a four-dimensional initial estimate <code>est</code> (typically from the art function), this function performs ridge rank selection on each mode of the tensor using a ridge parameter <code>c</code>. The result is a vector of integers representing the selected ranks for each mode.</p><p><strong>Arguments</strong></p><ul><li><code>est::AbstractArray</code>: The input four-dimensional array (tensor) for ridge rank selection.</li><li><code>c::Real</code>: Ridge parameter controlling regularization strength.</li><li><code>r̄::Vector{Int} = collect(size(est))</code>: Vector specifying the maximum ranks to consider for each mode. Default is the size of the corresponding mode in <code>est</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: A vector containing the selected ranks for each mode of the input tensor.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">est = rand(3, 4, 5, 6)
c = 0.1
selected_ranks = ridgerankselect(est, c)</code></pre><p><strong>References</strong></p><ul><li>Lam, Clifford, and Qiwei Yao. &quot;Factor modeling for high-dimensional time series: inference for the number of factors.&quot; The Annals of Statistics (2012): 694-726.</li><li>Wang, Di, et al. &quot;High-dimensional vector autoregressive time series modeling via tensor decomposition.&quot; Journal of the American Statistical Association 117.539 (2022): 1338-1356.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/regutils.jl#L85-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.rrvar-Tuple{AbstractMatrix, Int64, Int64}" href="#CommonFeatures.rrvar-Tuple{AbstractMatrix, Int64, Int64}"><code>CommonFeatures.rrvar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rrvar(Y::AbstractMatrix, r::Int, p::Int)</code></pre><p>Compute reduced-rank vector autoregressive (RRVAR) model parameters.</p><p><strong>Arguments</strong></p><ul><li><code>Y::AbstractMatrix</code>: Input matrix with dimensions (k, T), where k is the number of variables and T is the number of observations.</li><li><code>r::Int</code>: Rank of the reduced-rank model.</li><li><code>p::Int</code>: Order of the autoregressive model.</li></ul><p><strong>Returns</strong></p><ul><li><code>C::Matrix</code>: Reduced-rank VAR coefficient matrix.</li><li><code>A::Matrix</code>: Left reduced-rank matrix.</li><li><code>B::Matrix</code>: Right reduced-rank matrix.</li></ul><p><strong>Details</strong></p><p>This function computes the reduced-rank VAR parameters using the method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/matrixar.jl#L59-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.rrvaric-Tuple{AbstractMatrix, Int64, Bool}" href="#CommonFeatures.rrvaric-Tuple{AbstractMatrix, Int64, Bool}"><code>CommonFeatures.rrvaric</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rrvaric(vardata, pmax, stdize)</code></pre><p>Compute the optimal rank of a reduced rank regression using information criteria.</p><p><strong>Fields</strong></p><ul><li><code>vardata::AbstractMatrix</code>: The data matrix where each column represents a variable and each row represents an observation.</li><li><code>pmax::Int</code>: The maximum lag order.</li><li><code>stdize::Bool</code>: Indicates whether to standardize the data or not.</li></ul><p><strong>Returns</strong></p><p>A tuple with the following elements:</p><ul><li>bic: The optimal rank based on the Bayesian Information Criterion.</li><li>aic: The optimal rank based on the Akaike Information Criterion.</li><li>hqc: The optimal rank based on the Hannan-Quinn Information Criterion.</li><li>ictable: A 5xN matrix where N is the number of valid rank combinations. Each column corresponds to a combination, and rows contain the following information:<ul><li>Row 1: Log determinant of the covariance matrix plus a penalty term (bic criterion).</li><li>Row 2: Log determinant of the covariance matrix plus a penalty term (aic criterion).</li><li>Row 3: Log determinant of the covariance matrix plus a penalty term (hqc criterion).</li><li>Row 4: The chosen rank.</li><li>Row 5: The chosen lag order.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/infocrit.jl#L256-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.simstats-Tuple{AbstractMatrix, AbstractVector, Int64}" href="#CommonFeatures.simstats-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>CommonFeatures.simstats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simstats(selectedranks, correctrank, sims)</code></pre><p>Calculate simulation statistics based on selected ranks, correct ranks, and the number of simulations.</p><p><strong>Arguments</strong></p><ul><li><code>selectedranks</code>::AbstractMatrix: Matrix of selected ranks for each simulation. Simulations should be along the rows.</li><li><code>correctrank</code>::AbstractVector: Vector of correct ranks for each simulation.</li><li><code>sims</code>::Int: CNumber of simulations.</li></ul><p><strong>Returns</strong></p><p>A named tuple containing the following statistics:</p><ul><li><code>avgrank</code>: Average rank for each simulation.</li><li><code>stdrank</code>: Standard deviation of ranks for each simulation.</li><li><code>freqcorrect</code>: Frequency of correct ranks for each simulation.</li><li><code>freqhigh</code>: Frequency of ranks higher than the correct rank for each simulation.</li><li><code>freqlow</code>: Frequency of ranks lower than the correct rank for each simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/SimFunctions/simutils.jl#L2-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.simulatetuckerdata-Tuple{AbstractVector, AbstractVector, Int64}" href="#CommonFeatures.simulatetuckerdata-Tuple{AbstractVector, AbstractVector, Int64}"><code>CommonFeatures.simulatetuckerdata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulatetuckerdata(dimvals, ranks, obs, scale)</code></pre><p>Simulate Tucker data with specified dimensions, ranks, observation count, and scaling factor.</p><p><strong>Arguments</strong></p><ul><li><code>dimvals::AbstractVector</code>: Dimensions of the tensor (dimvals[1] for the first mode, dimvals[2] for the second mode).</li><li><code>ranks::AbstractVector</code>: Tucker ranks for the four modes.</li><li><code>obs::Int</code>: Number of observations to simulate.</li><li><code>A::Array{Float64, 4}</code>: Coefficient tensor. If <code>nothing</code>, a random coefficient tensor will be generated.</li><li><code>p::Int</code>: Number of lags to include. Default is 1 and the maximum is 5.</li><li><code>snr::Real</code>: Desired signal-to-noise ratio. Default is 0.7.</li></ul><p><strong>Returns</strong></p><p>A named tuple containing:</p><ul><li><code>data::Array{Float64, 3}</code>: Simulated Tucker data with dimensions (dimvals[1], dimvals[2], obs).</li><li><code>A::Array{Float64, 4}</code>: Chosen coefficient tensor.</li><li>Σ::Array{Float64, 2}: Covariance matrix of the noise.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">result = simulatetuckerdata([5, 4], [2, 3, 2, 3], 100, 1.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/SimFunctions/simtucker.jl#L36-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.tensorols-Tuple{AbstractArray, AbstractArray}" href="#CommonFeatures.tensorols-Tuple{AbstractArray, AbstractArray}"><code>CommonFeatures.tensorols</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tensorols(Y, X)</code></pre><p>Compute tensor ordinary least squares equation by equation.</p><p><strong>Arguments</strong></p><ul><li><code>Y::AbstractArray</code>: Tensor of size (n1, n2, ..., nk, T).</li><li><code>X::AbstractArray</code>: Tensor of size (p1, p2, ..., pk, T).</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: Tensor of size (n1, n2, ..., nk, p1, p2, ..., pk).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/matrixar.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.tlag" href="#CommonFeatures.tlag"><code>CommonFeatures.tlag</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tlag(ten_data::AbstractArray, p=1)</code></pre><p>Create lagged arrays from a tensor-valued time series of the form N₁ × N₂ × … × Nₖ × T. New lagged is a tensor of size N<em>1 × N</em>2 × … × N_k × p × T.</p><p><strong>Arguments:</strong></p><ul><li><code>ten_data</code>: A tensor-valued time series with dimensions N₁ × N₂ × … × Nₖ × T, where N₁, N₂, ..., Nₖ represent the spatial dimensions, and T represents the time dimension.</li><li><code>p</code>: The number of lags to be created. Default is 1, indicating a single lag.</li></ul><p><strong>Returns:</strong></p><ul><li><code>original</code>: The original tensor without any lag.</li><li><code>lagged</code>: A tensor containing lagged versions of the original tensor, with dimensions N₁ × N₂ × … × Nₖ × p × T, where lastdim is the size of the last dimension of the input tensor.</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs">data = randn(3, 4, 5, 10)  # Example tensor with dimensions 3 × 4 × 5 × 10
original, lagged = tlag(data, 2)  # Create lagged arrays with 2 lags</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/regutils.jl#L36-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.tuckerpar" href="#CommonFeatures.tuckerpar"><code>CommonFeatures.tuckerpar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tuckerpar(dimvals::AbstractVector, ranks::AbstractVector, P::Integer=1)</code></pre><p>Compute the Tucker compression parameter for a tensor with specified dimensions and Tucker ranks.</p><p><strong>Arguments</strong></p><ul><li><code>dimvals::AbstractVector</code>: A vector representing the dimensions of the original tensor.</li><li><code>ranks::AbstractVector</code>: A vector representing the Tucker ranks for compression. It should have twice the length of <code>dimvals</code>.</li><li><code>P::Integer=1</code>: An optional parameter representing the mode-n unfolding size (default is 1).</li></ul><p><strong>Output</strong></p><ul><li>Returns the Tucker compression parameter for the given input.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">dimvals = [3, 4, 5]
ranks = [2, 3, 2, 4]
P = 2
result = tuckerpar(dimvals, ranks, P)
println(result)  # Output: 44</code></pre><p><strong>References</strong></p><ul><li>Tucker, L. R. (1966). Some mathematical notes on three-mode factor analysis. Psychometrika, 31(3), 279-311.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/infocrit.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CommonFeatures.tuckerreg-Tuple{AbstractArray, AbstractVector}" href="#CommonFeatures.tuckerreg-Tuple{AbstractArray, AbstractVector}"><code>CommonFeatures.tuckerreg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tuckerreg(mardata, ranks::AbstractVector, eta::Real, a=1, b=1, ϵ=1e-04, maxiter=1000, p=1,ϵ=1e-02)</code></pre><p>Perform a matrix autoregression with one lag (MAR(1)) with a reduced tucker rank along the coefficients. Uses the gradient descent algorithm of Wang, Zhang, and Li 2024.</p><p><strong>Arguments</strong></p><ul><li><code>mardata::AbstractArray</code>: Input tensor data. Should be <span>$N1 	imes N2 	imes T$</span></li><li><code>ranks::AbstractVector</code>: Vector specifying the desired ranks of the Tucker decomposition.</li><li><code>eta::AbstractFloat</code>: Learning rate for gradient descent (default: 1e-03).</li><li><code>a::Real</code>: Regularization parameter (default: 1).</li><li><code>b::Real</code>: Regularization parameter (default: 1).</li><li><code>maxiter::Int</code>: Maximum number of iterations for gradient descent (default: 3000).</li><li><code>p::Int</code>: Number of lags to include</li><li><code>ϵ::AbstractFloat</code>: Convergence threshold for stopping criteria (default: 1e-03).</li></ul><p><strong>Returns</strong></p><p>A tuple containing the Tucker decomposition components:</p><ul><li><code>G</code>: Core tensor.</li><li><code>U1</code>, <code>U2</code>, <code>U3</code>, <code>U4</code>: Factor matrices.</li><li><code>A</code>: Full Tucker decomposition tensor.</li><li><code>iters</code>: Number of iterations performed.</li><li><code>fullgrads</code>: A matrix keeping track of gradients. Can be plotted to determine whether gradients behave properly.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ivanuricardo/CommonFeatures.jl/blob/8a16958b7b5f757d106dc085329effe256231582/src/Regressions/tuckerreg.jl#L56-L79">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 25 September 2024 08:38">Wednesday 25 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
